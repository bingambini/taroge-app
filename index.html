const PRODUCTS_CSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQH2mZB4PnZn6hJJRPgC_Ry0HTt7BvKiNmcNGyx7PVOMHY0rNFqhM4MneVoRI3kT00y6vxMMOoHbipA/pub?gid=0&output=csv'; 
const DESIGN_CSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQH2mZB4PnZn6hJJRPgC_Ry0HTt7BvKiNmcNGyx7PVOMHY0rNFqhM4MneVoRI3kT00y6vxMMOoHbipA/pub?gid=2144703770&output=csv';

async function loadStore() {
    try {
        // ბანერის ჩატვირთვა Design ტაბიდან
        const dRes = await fetch(DESIGN_CSV);
        const dData = await dRes.text();
        const designRows = dData.split('\n');
        // ვიღებთ B1 უჯრას (მეორე სვეტი პირველ ხაზზე სათაურის გარეშე)
        const bannerUrl = designRows[1].split(',')[1].trim();
        document.getElementById('main-banner-img').src = bannerUrl;

        // პროდუქტების ჩატვირთვა Products ტაბიდან
        const pRes = await fetch(PRODUCTS_CSV);
        const pData = await pRes.text();
        const productRows = pData.split('\n').slice(1);
        const grid = document.getElementById('product-grid');
        grid.innerHTML = '';

        productRows.forEach(row => {
            const columns = row.split(',');
            if(columns.length >= 3) {
                const [name, price, photo] = columns;
                grid.innerHTML += `
                    <div class="product-card" onclick="buyItem('${name}', '${price}')">
                        <img src="${photo.trim()}" class="prod-img" onerror="this.src='https://via.placeholder.com/150'">
                        <div style="font-weight:700;">${name}</div>
                        <div style="color:var(--accent); font-weight:800;">${price}₾</div>
                    </div>`;
            }
        });
    } catch (e) {
        console.error("ჩატვირთვის შეცდომა:", e);
    }
}
